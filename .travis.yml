dist: xenial
language: cpp
os:
  - linux
arch:
  - ppc64le

services:
  - docker

env:
  global:
    - ARTIFACTS_BUCKET=frocksdb-build-artifacts
    - ARTIFACTS_KEY=$AWS_ACCESS_KEY_ID
    - ARTIFACTS_SECRET=$AWS_ACCESS_SECRET_KEY
  jobs:
    - CMD=rocksdbjavastaticdockerppc64le
    - CMD=rocksdbjavastaticdockerppc64lemusl

addons:
  artifacts:
    paths:
      - $TRAVIS_BUILD_DIR/java/target/librocksdbjni-linux-ppc64le-musl.so
      - $TRAVIS_BUILD_DIR/java/target/librocksdbjni-linux-ppc64le.so

install:
  - sudo apt-get install -y openjdk-8-jdk || exit $?
  - export PATH=/usr/lib/jvm/java-8-openjdk-$(dpkg --print-architecture)/bin:$PATH
  - export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-$(dpkg --print-architecture)
  - echo "JAVA_HOME=${JAVA_HOME}"
  - which java && java -version
  - which javac && javac -version

script:
  - make jclean clean $CMD
